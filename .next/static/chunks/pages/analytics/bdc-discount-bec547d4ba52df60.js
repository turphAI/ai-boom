(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128],{1576:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/analytics/bdc-discount",function(){return a(6574)}])},6574:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(7876),i=a(4232),c=a(3905),n=a(727),r=a(5682),l=a(7041),d=a(1899),o=a(4660),x=a(9457),h=a(2885),m=a(5851),u=a(6795),g=a(7581),j=a(8230),p=a.n(j),v=a(7831),y=a(7937),N=a(2745);function f(){let[e,t]=(0,i.useState)(null),[a,j]=(0,i.useState)([]),[f,b]=(0,i.useState)(!0),[w,D]=(0,i.useState)(null),[C,_]=(0,i.useState)({isOpen:!1,title:"",data:[],dataKey:"value",color:"#10b981",unit:"%",type:"line"}),[B,k]=(0,i.useState)(!1),[E,F]=(0,i.useState)({start:new Date(Date.now()-7776e6),end:new Date}),[S,T]=(0,i.useState)([]),[A,Z]=(0,i.useState)([]);(0,i.useEffect)(()=>{M()},[]);let M=async()=>{try{var e,a,s,i;b(!0),D(null);let c=await fetch("/api/metrics/current"),n=await c.json();if(!n.success)throw Error("Failed to fetch current metrics");let r=n.metrics.find(e=>"bdc_discount"===e.key);if(!r)throw Error("BDC discount metric not found");let l=await fetch("/api/metrics/historical?days=365"),d=await l.json();if(!d.success)throw Error("Failed to fetch historical data");let o=d.data.bdc_discount||[],x={currentValue:100*r.value,changePercent:r.changePercent,trend:r.changePercent>2?"up":r.changePercent<-2?"down":"stable",status:r.status,historicalData:o.map(e=>({timestamp:e.timestamp,value:100*e.value,date:e.date||e.timestamp.split("T")[0]})),breakdown:{byBDC:(null==(e=r.metadata)?void 0:e.individual_bdcs)?Object.entries(r.metadata.individual_bdcs).map(e=>{let[t,a]=e;return{name:a.name,ticker:t,value:a.discount_percentage,percentage:a.discount_percentage/(100*r.value)*100}}):[],bySector:[{sector:"Technology",value:100*r.value*.4,percentage:40},{sector:"Healthcare",value:100*r.value*.3,percentage:30},{sector:"Financial",value:100*r.value*.3,percentage:30}],bySize:[{size:"Large Cap",value:100*r.value*.5,percentage:50},{size:"Mid Cap",value:100*r.value*.3,percentage:30},{size:"Small Cap",value:100*r.value*.2,percentage:20}]},insights:{keyTrends:["BDC discount is ".concat(r.changePercent>0?"increasing":"decreasing"," by ").concat(Math.abs(r.changePercent).toFixed(1),"%"),"Average discount across ".concat((null==(a=r.metadata)?void 0:a.bdc_count)||3," BDCs is ").concat((100*r.value).toFixed(1),"%"),"Individual BDC discounts range from ".concat(Math.min(...(null==(s=r.metadata)?void 0:s.individual_bdcs)?Object.values(r.metadata.individual_bdcs).map(e=>e.discount_percentage):[0]).toFixed(1),"% to ").concat(Math.max(...(null==(i=r.metadata)?void 0:i.individual_bdcs)?Object.values(r.metadata.individual_bdcs).map(e=>e.discount_percentage):[0]).toFixed(1),"%")],riskFactors:r.value>.1?["High BDC discounts may indicate market stress","Increasing discounts suggest declining investor confidence"]:[],recommendations:["Monitor BDC NAV trends for signs of asset quality deterioration","Track individual BDC performance for early warning signals"]}};t(x),j(x.historicalData),Z(x.historicalData)}catch(e){console.error("Error fetching analytics:",e),D(e instanceof Error?e.message:"Failed to fetch analytics")}finally{b(!1)}},P=(e,t,s)=>{let i=a.filter(a=>{let s=new Date(a.timestamp);return s>=e&&s<=t});s.length,Z(i)},O=e=>{switch(e){case"increasing":return(0,s.jsx)(d.A,{className:"h-4 w-4 text-red-600"});case"decreasing":return(0,s.jsx)(o.A,{className:"h-4 w-4 text-green-600"});default:return(0,s.jsx)(x.A,{className:"h-4 w-4 text-gray-600"})}};return f?(0,s.jsx)(c.N,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"text-lg",children:"Loading analytics..."})})}):w?(0,s.jsx)(c.N,{children:(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-red-600",children:w})})}):e?(0,s.jsx)(c.N,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center space-x-2 mb-2",children:(0,s.jsx)(p(),{href:"/analytics",children:(0,s.jsxs)(l.$,{variant:"ghost",size:"sm",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Back to Analytics"]})})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"BDC Discount Analytics"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Monitor BDC market stress and performance indicators"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Average Discount"}),O(e.trend)]}),(0,s.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:[e.currentValue.toFixed(1),"%"]}),(0,s.jsxs)("div",{className:"text-sm mt-2 ".concat(e.changePercent>0?"text-red-600":"text-green-600"),children:[e.changePercent>0?"+":"",e.changePercent.toFixed(1),"% from previous period"]})]})}),(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Trend"}),(0,s.jsx)(r.E,{variant:"up"===e.trend?"destructive":"down"===e.trend?"default":"secondary",children:e.trend})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-gray-900 capitalize",children:e.trend}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-2",children:"Market stress pattern"})]})}),(0,s.jsx)(n.Zp,{children:(0,s.jsxs)(n.Wu,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Red Flags"}),"critical"===e.status&&(0,s.jsx)(m.A,{className:"h-5 w-5 text-red-500"})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:e.status}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-2",children:"Status"})]})})]}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"flex items-center space-x-2",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Category Breakdown"})]})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Object.entries(e.breakdown.bySector).map(t=>{let[a,i]=t;return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 capitalize",children:a}),O(e.trend)]}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[i.percentage.toFixed(1),"%"]}),(0,s.jsxs)("div",{className:"text-sm ".concat(i.percentage>0?"text-red-600":"text-green-600"),children:[i.percentage>0?"+":"",i.percentage.toFixed(1),"%"]}),(0,s.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,s.jsx)("div",{className:"font-medium mb-1",children:"Key Entities:"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-2 py-1 rounded",children:"Example Entity 1"}),(0,s.jsx)("div",{className:"bg-gray-50 px-2 py-1 rounded",children:"Example Entity 2"}),(0,s.jsx)("div",{className:"bg-gray-50 px-2 py-1 rounded",children:"Example Entity 3"}),e.breakdown.bySector.length>3&&(0,s.jsxs)("div",{className:"text-gray-500",children:["+",e.breakdown.bySector.length-3," more"]})]})]})]},a)})})})]}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Cross-Metric Correlations"})]})}),(0,s.jsx)(n.Wu,{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 capitalize",children:"BDC Discount Correlation"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"0.85"}),(0,s.jsx)(r.E,{className:"bg-green-100 text-green-600",children:"Strong Positive"}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Strong positive correlation with BDC NAV."})]},"bdc_discount_correlation"),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 capitalize",children:"BDC NAV Correlation"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"0.75"}),(0,s.jsx)(r.E,{className:"bg-yellow-100 text-yellow-600",children:"Moderate Positive"}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Moderate positive correlation with BDC NAV."})]},"bdc_nav_correlation"),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 capitalize",children:"Market Stress Correlation"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"0.65"}),(0,s.jsx)(r.E,{className:"bg-blue-100 text-blue-600",children:"Weak Positive"}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Weak positive correlation with market stress."})]},"market_stress_correlation")]})})]}),"critical"===e.status&&(0,s.jsxs)(n.Zp,{children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"flex items-center space-x-2 text-red-700",children:[(0,s.jsx)(m.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Red Flags & Insights"})]})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"space-y-3",children:e.insights.riskFactors.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-red-50 rounded-lg",children:[(0,s.jsx)(m.A,{className:"h-5 w-5 text-red-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-red-800",children:e}),(0,s.jsx)("div",{className:"text-sm text-red-600 mt-1",children:"This may indicate increased stress in the BDC financing sector."})]})]},t))})})]}),(0,s.jsx)(v.Z,{title:"BDC Discount Historical Trend",data:a,dataKey:"value",color:"#10b981",unit:"%",type:"line",showTrend:!0,height:400,dangerThreshold:20,warningThreshold:15,enableZoom:!0,enableDrillDown:!0,onDrillDown:e=>{_({isOpen:!0,title:"BDC Discount Historical Trend",data:a,dataKey:"value",color:"#10b981",unit:"%",type:"line"})},formatValue:e=>"".concat(e.toFixed(1),"%"),formatDate:e=>new Date(e).toLocaleDateString(),filteredData:A,showFilteredData:A.length!==a.length}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)(v.Z,{title:"Technology BDCs",data:a.slice(0,30),dataKey:"value",color:"#3b82f6",unit:"%",type:"area",showTrend:!0,height:300,formatValue:e=>"".concat((.35*e).toFixed(1),"%"),formatDate:e=>new Date(e).toLocaleDateString()}),(0,s.jsx)(v.Z,{title:"Healthcare BDCs",data:a.slice(0,30),dataKey:"value",color:"#8b5cf6",unit:"%",type:"area",showTrend:!0,height:300,formatValue:e=>"".concat((.25*e).toFixed(1),"%"),formatDate:e=>new Date(e).toLocaleDateString()}),(0,s.jsx)(v.Z,{title:"Energy BDCs",data:a.slice(0,30),dataKey:"value",color:"#f59e0b",unit:"%",type:"area",showTrend:!0,height:300,formatValue:e=>"".concat((.4*e).toFixed(1),"%"),formatDate:e=>new Date(e).toLocaleDateString()})]}),(0,s.jsx)(y.z,{isOpen:C.isOpen,onClose:()=>{_(e=>({...e,isOpen:!1}))},title:C.title,data:C.data,dataKey:C.dataKey,color:C.color,unit:C.unit,type:C.type}),(0,s.jsx)(N.Z,{isOpen:B,onToggle:()=>k(!B),onDateRangeChange:(e,t)=>{F({start:e,end:t}),P(e,t,S)},availableMetrics:["bdc_discount","technology","healthcare","energy"],selectedMetrics:S,onMetricsChange:e=>{T(e),P(E.start,E.end,e)},onResetFilters:()=>{F({start:new Date(Date.now()-7776e6),end:new Date}),T([]),Z(a)},activeFiltersCount:+(A.length!==a.length)+ +(S.length>0)})]})}):(0,s.jsx)(c.N,{children:(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-gray-600",children:"No analytics data available"})})})}}},e=>{e.O(0,[269,669,726,770,11,519,585,636,593,792],()=>e(e.s=1576)),_N_E=e.O()}]);