"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/metrics/historical";
exports.ids = ["pages/api/metrics/historical"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fhistorical&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fhistorical.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fhistorical&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fhistorical.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/./node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_metrics_historical_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./src/pages/api/metrics/historical.ts */ \"(api-node)/./src/pages/api/metrics/historical.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_metrics_historical_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_src_pages_api_metrics_historical_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/metrics/historical\",\n        pathname: \"/api/metrics/historical\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_metrics_historical_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    projectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/metrics/historical\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: undefined,\n                multiZoneDraftMode: Boolean(\"false\"),\n                trustHostHeader: undefined,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/metrics/historical\",\n                projectDir:  false || '',\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGbWV0cmljcyUyRmhpc3RvcmljYWwmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlMkZwYWdlcyUyRmFwaSUyRm1ldHJpY3MlMkZoaXN0b3JpY2FsLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUF1RDtBQUNDO0FBQ3VDO0FBQ3JDO0FBQzFEO0FBQ2tFO0FBQ007QUFDRjtBQUN0RTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsaUVBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGlFQUFRO0FBQ3BDO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osYUFBYSxPQUFvQyxJQUFJLENBQUU7QUFDdkQsZ0JBQWdCLE1BQXVDO0FBQ3ZELENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxLQUFxQixFQUFFLEVBRTFCO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLG1DQUFtQztBQUMvQztBQUNBO0FBQ0EsdUJBQXVCLDRFQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLDZDQUE2QyxTQUE2QztBQUMxRiw0Q0FBNEMsT0FBd0M7QUFDcEYsaUNBQWlDLFNBQW9DO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixNQUF1QztBQUNuRTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGdGQUFjO0FBQy9FLCtEQUErRCx5Q0FBeUM7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsUUFBUSxFQUFFLE1BQU07QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxrQkFBa0I7QUFDbEIsdUNBQXVDLFFBQVEsRUFBRSxRQUFRO0FBQ3pEO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEscUVBQVM7QUFDakIsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNlbmRFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2FwaS11dGlsc1wiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmMvcGFnZXMvYXBpL21ldHJpY3MvaGlzdG9yaWNhbC50c1wiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9tZXRyaWNzL2hpc3RvcmljYWxcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9tZXRyaWNzL2hpc3RvcmljYWxcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZCxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnXG59KTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICBsZXQgc3JjUGFnZSA9IFwiL2FwaS9tZXRyaWNzL2hpc3RvcmljYWxcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvbWV0cmljcy9oaXN0b3JpY2FsXCIsXG4gICAgICAgICAgICAgICAgcHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgICAgICAgICAgICAgIG9uRXJyb3I6ICguLi5hcmdzKT0+b25SZXF1ZXN0RXJyb3IocmVxLCAuLi5hcmdzKVxuICAgICAgICAgICAgfSkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW52b2tlUm91dGVNb2R1bGUpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvLyB3ZSByZS10aHJvdyBpbiBkZXYgdG8gc2hvdyB0aGUgZXJyb3Igb3ZlcmxheVxuICAgICAgICBpZiAocm91dGVNb2R1bGUuaXNEZXYpIHtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGlzIGlzIHRlY2huaWNhbGx5IGFuIGludmFyaWFudCBhcyBlcnJvciBoYW5kbGluZ1xuICAgICAgICAvLyBzaG91bGQgYmUgZG9uZSBpbnNpZGUgb2YgYXBpLXJlc29sdmVyIG9uRXJyb3JcbiAgICAgICAgc2VuZEVycm9yKHJlcywgNTAwLCAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyk7XG4gICAgfSBmaW5hbGx5e1xuICAgICAgICAvLyBXZSBkb24ndCBhbGxvdyBhbnkgd2FpdFVudGlsIHdvcmsgaW4gcGFnZXMgQVBJIHJvdXRlcyBjdXJyZW50bHlcbiAgICAgICAgLy8gc28gaWYgY2FsbGJhY2sgaXMgcHJlc2VudCByZXR1cm4gd2l0aCByZXNvbHZlZCBwcm9taXNlIHNpbmNlIG5vXG4gICAgICAgIC8vIHBlbmRpbmcgd29ya1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fhistorical&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fhistorical.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/lib/data/real-data-service.ts":
/*!*******************************************!*\
  !*** ./src/lib/data/real-data-service.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   realDataService: () => (/* binding */ realDataService)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass FileBasedRealDataService {\n    async getLatestMetrics() {\n        try {\n            const files = await this.getDataFiles();\n            const metrics = [];\n            for (const file of files){\n                const data = await this.readDataFile(file);\n                if (data.length > 0) {\n                    const latest = data[0] // Most recent data point\n                    ;\n                    const metricKey = this.getMetricKey(latest.data_source, latest.metric_name);\n                    // Calculate change from previous data point if available\n                    let change = 0;\n                    let changePercent = 0;\n                    if (data.length > 1) {\n                        const previous = data[1];\n                        change = latest.data.value - previous.data.value;\n                        changePercent = previous.data.value !== 0 ? change / previous.data.value * 100 : 0;\n                    }\n                    // Determine status based on thresholds\n                    const status = this.getStatus(latest.data.value, metricKey);\n                    const metric = {\n                        key: metricKey,\n                        name: this.formatMetricName(latest.data_source, latest.metric_name),\n                        value: latest.data.value,\n                        unit: this.getUnit(metricKey),\n                        change,\n                        changePercent,\n                        status,\n                        lastUpdated: latest.timestamp,\n                        source: latest.data_source,\n                        confidence: latest.data.confidence,\n                        metadata: latest.data.metadata\n                    };\n                    metrics.push(metric);\n                }\n            }\n            return metrics;\n        } catch (error) {\n            console.error('Error reading real data:', error);\n            return [];\n        }\n    }\n    async getHistoricalData(metricKey, days) {\n        try {\n            const files = await this.getDataFiles();\n            const cutoffDate = new Date();\n            cutoffDate.setDate(cutoffDate.getDate() - days);\n            for (const file of files){\n                const data = await this.readDataFile(file);\n                if (data.length > 0) {\n                    const fileMetricKey = this.getMetricKey(data[0].data_source, data[0].metric_name);\n                    if (fileMetricKey === metricKey) {\n                        return data.filter((point)=>new Date(point.timestamp) >= cutoffDate).map((point)=>({\n                                timestamp: point.timestamp,\n                                value: point.data.value,\n                                metadata: point.data.metadata\n                            })).sort((a, b)=>new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());\n                    }\n                }\n            }\n            return [];\n        } catch (error) {\n            console.error('Error reading historical data:', error);\n            return [];\n        }\n    }\n    async getDataSources() {\n        try {\n            const files = await this.getDataFiles();\n            const sources = new Set();\n            for (const file of files){\n                const data = await this.readDataFile(file);\n                if (data.length > 0) {\n                    sources.add(data[0].data_source);\n                }\n            }\n            return Array.from(sources);\n        } catch (error) {\n            console.error('Error reading data sources:', error);\n            return [];\n        }\n    }\n    async getDataFiles() {\n        try {\n            const files = await fs__WEBPACK_IMPORTED_MODULE_0___default().promises.readdir(this.dataDir);\n            return files.filter((file)=>file.endsWith('.json')).filter((file)=>!file.includes('dashboard_alerts')) // Skip alert history files\n            .filter((file)=>!file.includes('test_')) // Skip test files\n            .filter((file)=>!file.includes('health_check_')) // Skip health check test files\n            .filter((file)=>!file.includes('comprehensive_test_')) // Skip comprehensive test files\n            .map((file)=>path__WEBPACK_IMPORTED_MODULE_1___default().join(this.dataDir, file));\n        } catch (error) {\n            console.error('Error reading data directory:', error);\n            return [];\n        }\n    }\n    async readDataFile(filePath) {\n        try {\n            const content = await fs__WEBPACK_IMPORTED_MODULE_0___default().promises.readFile(filePath, 'utf-8');\n            return JSON.parse(content);\n        } catch (error) {\n            console.error(`Error reading file ${filePath}:`, error);\n            return [];\n        }\n    }\n    getMetricKey(dataSource, metricName) {\n        // Map scraper data sources to dashboard metric keys\n        const mapping = {\n            'bond_issuance': 'bond_issuance',\n            'bdc_discount': 'bdc_discount',\n            'credit_fund': 'credit_fund',\n            'bank_provision': 'bank_provision'\n        };\n        // Handle specific metric name mappings for legitimate scrapers\n        if (dataSource === 'bond_issuance' && metricName === 'weekly') {\n            return 'bond_issuance';\n        }\n        if (dataSource === 'bdc_discount' && metricName === 'discount_to_nav') {\n            return 'bdc_discount';\n        }\n        return mapping[dataSource] || `${dataSource}_${metricName}`;\n    }\n    formatMetricName(dataSource, metricName) {\n        const nameMapping = {\n            'bond_issuance': 'Bond Issuance',\n            'bdc_discount': 'BDC Discount',\n            'credit_fund': 'Credit Fund Assets',\n            'bank_provision': 'Bank Provisions'\n        };\n        return nameMapping[dataSource] || `${dataSource} ${metricName}`.replace(/_/g, ' ').replace(/\\b\\w/g, (l)=>l.toUpperCase());\n    }\n    getUnit(metricKey) {\n        const unitMapping = {\n            'bond_issuance': 'currency',\n            'bdc_discount': 'percent',\n            'credit_fund': 'currency',\n            'bank_provision': 'percent'\n        };\n        return unitMapping[metricKey] || 'unit';\n    }\n    getStatus(value, metricKey) {\n        const thresholds = {\n            'bond_issuance': {\n                warning: 4000000000,\n                critical: 5000000000\n            },\n            'bdc_discount': {\n                warning: 8,\n                critical: 10\n            },\n            'credit_fund': {\n                warning: 80000000000,\n                critical: 100000000000\n            },\n            'bank_provision': {\n                warning: 12,\n                critical: 15\n            } // 12%, 15%\n        };\n        const threshold = thresholds[metricKey];\n        if (!threshold) return 'healthy';\n        if (value >= threshold.critical) return 'critical';\n        if (value >= threshold.warning) return 'warning';\n        return 'healthy';\n    }\n    constructor(){\n        this.dataDir = '/Users/turphai/Projects/kiro_aiCrash/data';\n    }\n}\n// Export singleton instance\nconst realDataService = new FileBasedRealDataService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9saWIvZGF0YS9yZWFsLWRhdGEtc2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFtQjtBQUNJO0FBc0J2QixNQUFNRTtJQUdKLE1BQU1DLG1CQUFtQztRQUN2QyxJQUFJO1lBQ0YsTUFBTUMsUUFBUSxNQUFNLElBQUksQ0FBQ0MsWUFBWTtZQUNyQyxNQUFNQyxVQUFpQixFQUFFO1lBRXpCLEtBQUssTUFBTUMsUUFBUUgsTUFBTztnQkFDeEIsTUFBTUksT0FBTyxNQUFNLElBQUksQ0FBQ0MsWUFBWSxDQUFDRjtnQkFFckMsSUFBSUMsS0FBS0UsTUFBTSxHQUFHLEdBQUc7b0JBQ25CLE1BQU1DLFNBQVNILElBQUksQ0FBQyxFQUFFLENBQUMseUJBQXlCOztvQkFDaEQsTUFBTUksWUFBWSxJQUFJLENBQUNDLFlBQVksQ0FBQ0YsT0FBT0csV0FBVyxFQUFFSCxPQUFPSSxXQUFXO29CQUUxRSx5REFBeUQ7b0JBQ3pELElBQUlDLFNBQVM7b0JBQ2IsSUFBSUMsZ0JBQWdCO29CQUNwQixJQUFJVCxLQUFLRSxNQUFNLEdBQUcsR0FBRzt3QkFDbkIsTUFBTVEsV0FBV1YsSUFBSSxDQUFDLEVBQUU7d0JBQ3hCUSxTQUFTTCxPQUFPSCxJQUFJLENBQUNXLEtBQUssR0FBR0QsU0FBU1YsSUFBSSxDQUFDVyxLQUFLO3dCQUNoREYsZ0JBQWdCQyxTQUFTVixJQUFJLENBQUNXLEtBQUssS0FBSyxJQUNwQyxTQUFVRCxTQUFTVixJQUFJLENBQUNXLEtBQUssR0FBSSxNQUNqQztvQkFDTjtvQkFFQSx1Q0FBdUM7b0JBQ3ZDLE1BQU1DLFNBQVMsSUFBSSxDQUFDQyxTQUFTLENBQUNWLE9BQU9ILElBQUksQ0FBQ1csS0FBSyxFQUFFUDtvQkFFakQsTUFBTVUsU0FBUzt3QkFDYkMsS0FBS1g7d0JBQ0xZLE1BQU0sSUFBSSxDQUFDQyxnQkFBZ0IsQ0FBQ2QsT0FBT0csV0FBVyxFQUFFSCxPQUFPSSxXQUFXO3dCQUNsRUksT0FBT1IsT0FBT0gsSUFBSSxDQUFDVyxLQUFLO3dCQUN4Qk8sTUFBTSxJQUFJLENBQUNDLE9BQU8sQ0FBQ2Y7d0JBQ25CSTt3QkFDQUM7d0JBQ0FHO3dCQUNBUSxhQUFhakIsT0FBT2tCLFNBQVM7d0JBQzdCQyxRQUFRbkIsT0FBT0csV0FBVzt3QkFDMUJpQixZQUFZcEIsT0FBT0gsSUFBSSxDQUFDdUIsVUFBVTt3QkFDbENDLFVBQVVyQixPQUFPSCxJQUFJLENBQUN3QixRQUFRO29CQUNoQztvQkFFQTFCLFFBQVEyQixJQUFJLENBQUNYO2dCQUNmO1lBQ0Y7WUFFQSxPQUFPaEI7UUFDVCxFQUFFLE9BQU80QixPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyw0QkFBNEJBO1lBQzFDLE9BQU8sRUFBRTtRQUNYO0lBQ0Y7SUFFQSxNQUFNRSxrQkFBa0J4QixTQUFpQixFQUFFeUIsSUFBWSxFQUFrQjtRQUN2RSxJQUFJO1lBQ0YsTUFBTWpDLFFBQVEsTUFBTSxJQUFJLENBQUNDLFlBQVk7WUFDckMsTUFBTWlDLGFBQWEsSUFBSUM7WUFDdkJELFdBQVdFLE9BQU8sQ0FBQ0YsV0FBV0csT0FBTyxLQUFLSjtZQUUxQyxLQUFLLE1BQU05QixRQUFRSCxNQUFPO2dCQUN4QixNQUFNSSxPQUFPLE1BQU0sSUFBSSxDQUFDQyxZQUFZLENBQUNGO2dCQUNyQyxJQUFJQyxLQUFLRSxNQUFNLEdBQUcsR0FBRztvQkFDbkIsTUFBTWdDLGdCQUFnQixJQUFJLENBQUM3QixZQUFZLENBQUNMLElBQUksQ0FBQyxFQUFFLENBQUNNLFdBQVcsRUFBRU4sSUFBSSxDQUFDLEVBQUUsQ0FBQ08sV0FBVztvQkFFaEYsSUFBSTJCLGtCQUFrQjlCLFdBQVc7d0JBQy9CLE9BQU9KLEtBQ0ptQyxNQUFNLENBQUNDLENBQUFBLFFBQVMsSUFBSUwsS0FBS0ssTUFBTWYsU0FBUyxLQUFLUyxZQUM3Q08sR0FBRyxDQUFDRCxDQUFBQSxRQUFVO2dDQUNiZixXQUFXZSxNQUFNZixTQUFTO2dDQUMxQlYsT0FBT3lCLE1BQU1wQyxJQUFJLENBQUNXLEtBQUs7Z0NBQ3ZCYSxVQUFVWSxNQUFNcEMsSUFBSSxDQUFDd0IsUUFBUTs0QkFDL0IsSUFDQ2MsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU0sSUFBSVQsS0FBS1EsRUFBRWxCLFNBQVMsRUFBRW9CLE9BQU8sS0FBSyxJQUFJVixLQUFLUyxFQUFFbkIsU0FBUyxFQUFFb0IsT0FBTztvQkFDbkY7Z0JBQ0Y7WUFDRjtZQUVBLE9BQU8sRUFBRTtRQUNYLEVBQUUsT0FBT2YsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsa0NBQWtDQTtZQUNoRCxPQUFPLEVBQUU7UUFDWDtJQUNGO0lBRUEsTUFBTWdCLGlCQUFvQztRQUN4QyxJQUFJO1lBQ0YsTUFBTTlDLFFBQVEsTUFBTSxJQUFJLENBQUNDLFlBQVk7WUFDckMsTUFBTThDLFVBQVUsSUFBSUM7WUFFcEIsS0FBSyxNQUFNN0MsUUFBUUgsTUFBTztnQkFDeEIsTUFBTUksT0FBTyxNQUFNLElBQUksQ0FBQ0MsWUFBWSxDQUFDRjtnQkFDckMsSUFBSUMsS0FBS0UsTUFBTSxHQUFHLEdBQUc7b0JBQ25CeUMsUUFBUUUsR0FBRyxDQUFDN0MsSUFBSSxDQUFDLEVBQUUsQ0FBQ00sV0FBVztnQkFDakM7WUFDRjtZQUVBLE9BQU93QyxNQUFNQyxJQUFJLENBQUNKO1FBQ3BCLEVBQUUsT0FBT2pCLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLCtCQUErQkE7WUFDN0MsT0FBTyxFQUFFO1FBQ1g7SUFDRjtJQUVBLE1BQWM3QixlQUFrQztRQUM5QyxJQUFJO1lBQ0YsTUFBTUQsUUFBUSxNQUFNSixrREFBVyxDQUFDeUQsT0FBTyxDQUFDLElBQUksQ0FBQ0MsT0FBTztZQUNwRCxPQUFPdEQsTUFDSnVDLE1BQU0sQ0FBQ3BDLENBQUFBLE9BQVFBLEtBQUtvRCxRQUFRLENBQUMsVUFDN0JoQixNQUFNLENBQUNwQyxDQUFBQSxPQUFRLENBQUNBLEtBQUtxRCxRQUFRLENBQUMscUJBQXFCLDJCQUEyQjthQUM5RWpCLE1BQU0sQ0FBQ3BDLENBQUFBLE9BQVEsQ0FBQ0EsS0FBS3FELFFBQVEsQ0FBQyxVQUFVLGtCQUFrQjthQUMxRGpCLE1BQU0sQ0FBQ3BDLENBQUFBLE9BQVEsQ0FBQ0EsS0FBS3FELFFBQVEsQ0FBQyxrQkFBa0IsK0JBQStCO2FBQy9FakIsTUFBTSxDQUFDcEMsQ0FBQUEsT0FBUSxDQUFDQSxLQUFLcUQsUUFBUSxDQUFDLHdCQUF3QixnQ0FBZ0M7YUFDdEZmLEdBQUcsQ0FBQ3RDLENBQUFBLE9BQVFOLGdEQUFTLENBQUMsSUFBSSxDQUFDeUQsT0FBTyxFQUFFbkQ7UUFDekMsRUFBRSxPQUFPMkIsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsaUNBQWlDQTtZQUMvQyxPQUFPLEVBQUU7UUFDWDtJQUNGO0lBRUEsTUFBY3pCLGFBQWFxRCxRQUFnQixFQUErQjtRQUN4RSxJQUFJO1lBQ0YsTUFBTUMsVUFBVSxNQUFNL0Qsa0RBQVcsQ0FBQ2dFLFFBQVEsQ0FBQ0YsVUFBVTtZQUNyRCxPQUFPRyxLQUFLQyxLQUFLLENBQUNIO1FBQ3BCLEVBQUUsT0FBTzdCLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLENBQUMsbUJBQW1CLEVBQUU0QixTQUFTLENBQUMsQ0FBQyxFQUFFNUI7WUFDakQsT0FBTyxFQUFFO1FBQ1g7SUFDRjtJQUVRckIsYUFBYXNELFVBQWtCLEVBQUVDLFVBQWtCLEVBQVU7UUFDbkUsb0RBQW9EO1FBQ3BELE1BQU1DLFVBQWtDO1lBQ3RDLGlCQUFpQjtZQUNqQixnQkFBZ0I7WUFDaEIsZUFBZTtZQUNmLGtCQUFrQjtRQUNwQjtRQUVBLCtEQUErRDtRQUMvRCxJQUFJRixlQUFlLG1CQUFtQkMsZUFBZSxVQUFVO1lBQzdELE9BQU87UUFDVDtRQUNBLElBQUlELGVBQWUsa0JBQWtCQyxlQUFlLG1CQUFtQjtZQUNyRSxPQUFPO1FBQ1Q7UUFFQSxPQUFPQyxPQUFPLENBQUNGLFdBQVcsSUFBSSxHQUFHQSxXQUFXLENBQUMsRUFBRUMsWUFBWTtJQUM3RDtJQUVRM0MsaUJBQWlCMEMsVUFBa0IsRUFBRUMsVUFBa0IsRUFBVTtRQUN2RSxNQUFNRSxjQUFzQztZQUMxQyxpQkFBaUI7WUFDakIsZ0JBQWdCO1lBQ2hCLGVBQWU7WUFDZixrQkFBa0I7UUFDcEI7UUFFQSxPQUFPQSxXQUFXLENBQUNILFdBQVcsSUFBSSxHQUFHQSxXQUFXLENBQUMsRUFBRUMsWUFBWSxDQUFDRyxPQUFPLENBQUMsTUFBTSxLQUFLQSxPQUFPLENBQUMsU0FBU0MsQ0FBQUEsSUFBS0EsRUFBRUMsV0FBVztJQUN4SDtJQUVROUMsUUFBUWYsU0FBaUIsRUFBVTtRQUN6QyxNQUFNOEQsY0FBc0M7WUFDMUMsaUJBQWlCO1lBQ2pCLGdCQUFnQjtZQUNoQixlQUFlO1lBQ2Ysa0JBQWtCO1FBQ3BCO1FBRUEsT0FBT0EsV0FBVyxDQUFDOUQsVUFBVSxJQUFJO0lBQ25DO0lBRVFTLFVBQVVGLEtBQWEsRUFBRVAsU0FBaUIsRUFBZ0Q7UUFDaEcsTUFBTStELGFBQW9FO1lBQ3hFLGlCQUFpQjtnQkFBRUMsU0FBUztnQkFBWUMsVUFBVTtZQUFXO1lBQzdELGdCQUFnQjtnQkFBRUQsU0FBUztnQkFBR0MsVUFBVTtZQUFHO1lBQzNDLGVBQWU7Z0JBQUVELFNBQVM7Z0JBQWFDLFVBQVU7WUFBYTtZQUM5RCxrQkFBa0I7Z0JBQUVELFNBQVM7Z0JBQUlDLFVBQVU7WUFBRyxFQUFFLFdBQVc7UUFDN0Q7UUFFQSxNQUFNQyxZQUFZSCxVQUFVLENBQUMvRCxVQUFVO1FBQ3ZDLElBQUksQ0FBQ2tFLFdBQVcsT0FBTztRQUV2QixJQUFJM0QsU0FBUzJELFVBQVVELFFBQVEsRUFBRSxPQUFPO1FBQ3hDLElBQUkxRCxTQUFTMkQsVUFBVUYsT0FBTyxFQUFFLE9BQU87UUFDdkMsT0FBTztJQUNUOzthQXpMUWxCLFVBQVU7O0FBMExwQjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNcUIsa0JBQWtCLElBQUk3RSwyQkFBMEIiLCJzb3VyY2VzIjpbIi9Vc2Vycy90dXJwaGFpL1Byb2plY3RzL2tpcm9fYWlDcmFzaC9zcmMvbGliL2RhdGEvcmVhbC1kYXRhLXNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcblxuaW50ZXJmYWNlIFNjcmFwZXJEYXRhUG9pbnQge1xuICBkYXRhX3NvdXJjZTogc3RyaW5nXG4gIG1ldHJpY19uYW1lOiBzdHJpbmdcbiAgdGltZXN0YW1wOiBzdHJpbmdcbiAgZGF0YToge1xuICAgIHZhbHVlOiBudW1iZXJcbiAgICB0aW1lc3RhbXA6IHN0cmluZ1xuICAgIGNvbmZpZGVuY2U6IG51bWJlclxuICAgIG1ldGFkYXRhPzogYW55XG4gICAgdmFsaWRhdGlvbl9jaGVja3N1bT86IHN0cmluZ1xuICAgIGFub21hbHlfc2NvcmU/OiBudW1iZXJcbiAgfVxufVxuXG5pbnRlcmZhY2UgUmVhbERhdGFTZXJ2aWNlIHtcbiAgZ2V0TGF0ZXN0TWV0cmljcygpOiBQcm9taXNlPGFueVtdPlxuICBnZXRIaXN0b3JpY2FsRGF0YShtZXRyaWNLZXk6IHN0cmluZywgZGF5czogbnVtYmVyKTogUHJvbWlzZTxhbnlbXT5cbiAgZ2V0RGF0YVNvdXJjZXMoKTogUHJvbWlzZTxzdHJpbmdbXT5cbn1cblxuY2xhc3MgRmlsZUJhc2VkUmVhbERhdGFTZXJ2aWNlIGltcGxlbWVudHMgUmVhbERhdGFTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBkYXRhRGlyID0gJy9Vc2Vycy90dXJwaGFpL1Byb2plY3RzL2tpcm9fYWlDcmFzaC9kYXRhJ1xuXG4gIGFzeW5jIGdldExhdGVzdE1ldHJpY3MoKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuZ2V0RGF0YUZpbGVzKClcbiAgICAgIGNvbnN0IG1ldHJpY3M6IGFueVtdID0gW11cblxuICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlYWREYXRhRmlsZShmaWxlKVxuICAgICAgICBcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGxhdGVzdCA9IGRhdGFbMF0gLy8gTW9zdCByZWNlbnQgZGF0YSBwb2ludFxuICAgICAgICAgIGNvbnN0IG1ldHJpY0tleSA9IHRoaXMuZ2V0TWV0cmljS2V5KGxhdGVzdC5kYXRhX3NvdXJjZSwgbGF0ZXN0Lm1ldHJpY19uYW1lKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIENhbGN1bGF0ZSBjaGFuZ2UgZnJvbSBwcmV2aW91cyBkYXRhIHBvaW50IGlmIGF2YWlsYWJsZVxuICAgICAgICAgIGxldCBjaGFuZ2UgPSAwXG4gICAgICAgICAgbGV0IGNoYW5nZVBlcmNlbnQgPSAwXG4gICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgY29uc3QgcHJldmlvdXMgPSBkYXRhWzFdXG4gICAgICAgICAgICBjaGFuZ2UgPSBsYXRlc3QuZGF0YS52YWx1ZSAtIHByZXZpb3VzLmRhdGEudmFsdWVcbiAgICAgICAgICAgIGNoYW5nZVBlcmNlbnQgPSBwcmV2aW91cy5kYXRhLnZhbHVlICE9PSAwIFxuICAgICAgICAgICAgICA/IChjaGFuZ2UgLyBwcmV2aW91cy5kYXRhLnZhbHVlKSAqIDEwMCBcbiAgICAgICAgICAgICAgOiAwXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRGV0ZXJtaW5lIHN0YXR1cyBiYXNlZCBvbiB0aHJlc2hvbGRzXG4gICAgICAgICAgY29uc3Qgc3RhdHVzID0gdGhpcy5nZXRTdGF0dXMobGF0ZXN0LmRhdGEudmFsdWUsIG1ldHJpY0tleSlcblxuICAgICAgICAgIGNvbnN0IG1ldHJpYyA9IHtcbiAgICAgICAgICAgIGtleTogbWV0cmljS2V5LFxuICAgICAgICAgICAgbmFtZTogdGhpcy5mb3JtYXRNZXRyaWNOYW1lKGxhdGVzdC5kYXRhX3NvdXJjZSwgbGF0ZXN0Lm1ldHJpY19uYW1lKSxcbiAgICAgICAgICAgIHZhbHVlOiBsYXRlc3QuZGF0YS52YWx1ZSxcbiAgICAgICAgICAgIHVuaXQ6IHRoaXMuZ2V0VW5pdChtZXRyaWNLZXkpLFxuICAgICAgICAgICAgY2hhbmdlLFxuICAgICAgICAgICAgY2hhbmdlUGVyY2VudCxcbiAgICAgICAgICAgIHN0YXR1cyxcbiAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBsYXRlc3QudGltZXN0YW1wLFxuICAgICAgICAgICAgc291cmNlOiBsYXRlc3QuZGF0YV9zb3VyY2UsXG4gICAgICAgICAgICBjb25maWRlbmNlOiBsYXRlc3QuZGF0YS5jb25maWRlbmNlLFxuICAgICAgICAgICAgbWV0YWRhdGE6IGxhdGVzdC5kYXRhLm1ldGFkYXRhXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIG1ldHJpY3MucHVzaChtZXRyaWMpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG1ldHJpY3NcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVhZGluZyByZWFsIGRhdGE6JywgZXJyb3IpXG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRIaXN0b3JpY2FsRGF0YShtZXRyaWNLZXk6IHN0cmluZywgZGF5czogbnVtYmVyKTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuZ2V0RGF0YUZpbGVzKClcbiAgICAgIGNvbnN0IGN1dG9mZkRhdGUgPSBuZXcgRGF0ZSgpXG4gICAgICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBkYXlzKVxuXG4gICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMucmVhZERhdGFGaWxlKGZpbGUpXG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBmaWxlTWV0cmljS2V5ID0gdGhpcy5nZXRNZXRyaWNLZXkoZGF0YVswXS5kYXRhX3NvdXJjZSwgZGF0YVswXS5tZXRyaWNfbmFtZSlcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoZmlsZU1ldHJpY0tleSA9PT0gbWV0cmljS2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICAgICAgICAuZmlsdGVyKHBvaW50ID0+IG5ldyBEYXRlKHBvaW50LnRpbWVzdGFtcCkgPj0gY3V0b2ZmRGF0ZSlcbiAgICAgICAgICAgICAgLm1hcChwb2ludCA9PiAoe1xuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogcG9pbnQudGltZXN0YW1wLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBwb2ludC5kYXRhLnZhbHVlLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBwb2ludC5kYXRhLm1ldGFkYXRhXG4gICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS50aW1lc3RhbXApLmdldFRpbWUoKSAtIG5ldyBEYXRlKGIudGltZXN0YW1wKS5nZXRUaW1lKCkpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBbXVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGhpc3RvcmljYWwgZGF0YTonLCBlcnJvcilcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldERhdGFTb3VyY2VzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLmdldERhdGFGaWxlcygpXG4gICAgICBjb25zdCBzb3VyY2VzID0gbmV3IFNldDxzdHJpbmc+KClcblxuICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLnJlYWREYXRhRmlsZShmaWxlKVxuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc291cmNlcy5hZGQoZGF0YVswXS5kYXRhX3NvdXJjZSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShzb3VyY2VzKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGRhdGEgc291cmNlczonLCBlcnJvcilcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0RGF0YUZpbGVzKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZmlsZXMgPSBhd2FpdCBmcy5wcm9taXNlcy5yZWFkZGlyKHRoaXMuZGF0YURpcilcbiAgICAgIHJldHVybiBmaWxlc1xuICAgICAgICAuZmlsdGVyKGZpbGUgPT4gZmlsZS5lbmRzV2l0aCgnLmpzb24nKSlcbiAgICAgICAgLmZpbHRlcihmaWxlID0+ICFmaWxlLmluY2x1ZGVzKCdkYXNoYm9hcmRfYWxlcnRzJykpIC8vIFNraXAgYWxlcnQgaGlzdG9yeSBmaWxlc1xuICAgICAgICAuZmlsdGVyKGZpbGUgPT4gIWZpbGUuaW5jbHVkZXMoJ3Rlc3RfJykpIC8vIFNraXAgdGVzdCBmaWxlc1xuICAgICAgICAuZmlsdGVyKGZpbGUgPT4gIWZpbGUuaW5jbHVkZXMoJ2hlYWx0aF9jaGVja18nKSkgLy8gU2tpcCBoZWFsdGggY2hlY2sgdGVzdCBmaWxlc1xuICAgICAgICAuZmlsdGVyKGZpbGUgPT4gIWZpbGUuaW5jbHVkZXMoJ2NvbXByZWhlbnNpdmVfdGVzdF8nKSkgLy8gU2tpcCBjb21wcmVoZW5zaXZlIHRlc3QgZmlsZXNcbiAgICAgICAgLm1hcChmaWxlID0+IHBhdGguam9pbih0aGlzLmRhdGFEaXIsIGZpbGUpKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGRhdGEgZGlyZWN0b3J5OicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZWFkRGF0YUZpbGUoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8U2NyYXBlckRhdGFQb2ludFtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBmcy5wcm9taXNlcy5yZWFkRmlsZShmaWxlUGF0aCwgJ3V0Zi04JylcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGNvbnRlbnQpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHJlYWRpbmcgZmlsZSAke2ZpbGVQYXRofTpgLCBlcnJvcilcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWV0cmljS2V5KGRhdGFTb3VyY2U6IHN0cmluZywgbWV0cmljTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBNYXAgc2NyYXBlciBkYXRhIHNvdXJjZXMgdG8gZGFzaGJvYXJkIG1ldHJpYyBrZXlzXG4gICAgY29uc3QgbWFwcGluZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAgICdib25kX2lzc3VhbmNlJzogJ2JvbmRfaXNzdWFuY2UnLFxuICAgICAgJ2JkY19kaXNjb3VudCc6ICdiZGNfZGlzY291bnQnLFxuICAgICAgJ2NyZWRpdF9mdW5kJzogJ2NyZWRpdF9mdW5kJyxcbiAgICAgICdiYW5rX3Byb3Zpc2lvbic6ICdiYW5rX3Byb3Zpc2lvbidcbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgc3BlY2lmaWMgbWV0cmljIG5hbWUgbWFwcGluZ3MgZm9yIGxlZ2l0aW1hdGUgc2NyYXBlcnNcbiAgICBpZiAoZGF0YVNvdXJjZSA9PT0gJ2JvbmRfaXNzdWFuY2UnICYmIG1ldHJpY05hbWUgPT09ICd3ZWVrbHknKSB7XG4gICAgICByZXR1cm4gJ2JvbmRfaXNzdWFuY2UnXG4gICAgfVxuICAgIGlmIChkYXRhU291cmNlID09PSAnYmRjX2Rpc2NvdW50JyAmJiBtZXRyaWNOYW1lID09PSAnZGlzY291bnRfdG9fbmF2Jykge1xuICAgICAgcmV0dXJuICdiZGNfZGlzY291bnQnXG4gICAgfVxuXG4gICAgcmV0dXJuIG1hcHBpbmdbZGF0YVNvdXJjZV0gfHwgYCR7ZGF0YVNvdXJjZX1fJHttZXRyaWNOYW1lfWBcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0TWV0cmljTmFtZShkYXRhU291cmNlOiBzdHJpbmcsIG1ldHJpY05hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbmFtZU1hcHBpbmc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAnYm9uZF9pc3N1YW5jZSc6ICdCb25kIElzc3VhbmNlJyxcbiAgICAgICdiZGNfZGlzY291bnQnOiAnQkRDIERpc2NvdW50JyxcbiAgICAgICdjcmVkaXRfZnVuZCc6ICdDcmVkaXQgRnVuZCBBc3NldHMnLFxuICAgICAgJ2JhbmtfcHJvdmlzaW9uJzogJ0JhbmsgUHJvdmlzaW9ucydcbiAgICB9XG5cbiAgICByZXR1cm4gbmFtZU1hcHBpbmdbZGF0YVNvdXJjZV0gfHwgYCR7ZGF0YVNvdXJjZX0gJHttZXRyaWNOYW1lfWAucmVwbGFjZSgvXy9nLCAnICcpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSlcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VW5pdChtZXRyaWNLZXk6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgdW5pdE1hcHBpbmc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAnYm9uZF9pc3N1YW5jZSc6ICdjdXJyZW5jeScsXG4gICAgICAnYmRjX2Rpc2NvdW50JzogJ3BlcmNlbnQnLFxuICAgICAgJ2NyZWRpdF9mdW5kJzogJ2N1cnJlbmN5JyxcbiAgICAgICdiYW5rX3Byb3Zpc2lvbic6ICdwZXJjZW50J1xuICAgIH1cblxuICAgIHJldHVybiB1bml0TWFwcGluZ1ttZXRyaWNLZXldIHx8ICd1bml0J1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRTdGF0dXModmFsdWU6IG51bWJlciwgbWV0cmljS2V5OiBzdHJpbmcpOiAnaGVhbHRoeScgfCAnd2FybmluZycgfCAnY3JpdGljYWwnIHwgJ3N0YWxlJyB7XG4gICAgY29uc3QgdGhyZXNob2xkczogUmVjb3JkPHN0cmluZywgeyB3YXJuaW5nOiBudW1iZXI7IGNyaXRpY2FsOiBudW1iZXIgfT4gPSB7XG4gICAgICAnYm9uZF9pc3N1YW5jZSc6IHsgd2FybmluZzogNDAwMDAwMDAwMCwgY3JpdGljYWw6IDUwMDAwMDAwMDAgfSwgLy8gJDRCLCAkNUJcbiAgICAgICdiZGNfZGlzY291bnQnOiB7IHdhcm5pbmc6IDgsIGNyaXRpY2FsOiAxMCB9LCAvLyA4JSwgMTAlXG4gICAgICAnY3JlZGl0X2Z1bmQnOiB7IHdhcm5pbmc6IDgwMDAwMDAwMDAwLCBjcml0aWNhbDogMTAwMDAwMDAwMDAwIH0sIC8vICQ4MEIsICQxMDBCXG4gICAgICAnYmFua19wcm92aXNpb24nOiB7IHdhcm5pbmc6IDEyLCBjcml0aWNhbDogMTUgfSAvLyAxMiUsIDE1JVxuICAgIH1cblxuICAgIGNvbnN0IHRocmVzaG9sZCA9IHRocmVzaG9sZHNbbWV0cmljS2V5XVxuICAgIGlmICghdGhyZXNob2xkKSByZXR1cm4gJ2hlYWx0aHknXG5cbiAgICBpZiAodmFsdWUgPj0gdGhyZXNob2xkLmNyaXRpY2FsKSByZXR1cm4gJ2NyaXRpY2FsJ1xuICAgIGlmICh2YWx1ZSA+PSB0aHJlc2hvbGQud2FybmluZykgcmV0dXJuICd3YXJuaW5nJ1xuICAgIHJldHVybiAnaGVhbHRoeSdcbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgcmVhbERhdGFTZXJ2aWNlID0gbmV3IEZpbGVCYXNlZFJlYWxEYXRhU2VydmljZSgpXG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiRmlsZUJhc2VkUmVhbERhdGFTZXJ2aWNlIiwiZ2V0TGF0ZXN0TWV0cmljcyIsImZpbGVzIiwiZ2V0RGF0YUZpbGVzIiwibWV0cmljcyIsImZpbGUiLCJkYXRhIiwicmVhZERhdGFGaWxlIiwibGVuZ3RoIiwibGF0ZXN0IiwibWV0cmljS2V5IiwiZ2V0TWV0cmljS2V5IiwiZGF0YV9zb3VyY2UiLCJtZXRyaWNfbmFtZSIsImNoYW5nZSIsImNoYW5nZVBlcmNlbnQiLCJwcmV2aW91cyIsInZhbHVlIiwic3RhdHVzIiwiZ2V0U3RhdHVzIiwibWV0cmljIiwia2V5IiwibmFtZSIsImZvcm1hdE1ldHJpY05hbWUiLCJ1bml0IiwiZ2V0VW5pdCIsImxhc3RVcGRhdGVkIiwidGltZXN0YW1wIiwic291cmNlIiwiY29uZmlkZW5jZSIsIm1ldGFkYXRhIiwicHVzaCIsImVycm9yIiwiY29uc29sZSIsImdldEhpc3RvcmljYWxEYXRhIiwiZGF5cyIsImN1dG9mZkRhdGUiLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJmaWxlTWV0cmljS2V5IiwiZmlsdGVyIiwicG9pbnQiLCJtYXAiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIiwiZ2V0RGF0YVNvdXJjZXMiLCJzb3VyY2VzIiwiU2V0IiwiYWRkIiwiQXJyYXkiLCJmcm9tIiwicHJvbWlzZXMiLCJyZWFkZGlyIiwiZGF0YURpciIsImVuZHNXaXRoIiwiaW5jbHVkZXMiLCJqb2luIiwiZmlsZVBhdGgiLCJjb250ZW50IiwicmVhZEZpbGUiLCJKU09OIiwicGFyc2UiLCJkYXRhU291cmNlIiwibWV0cmljTmFtZSIsIm1hcHBpbmciLCJuYW1lTWFwcGluZyIsInJlcGxhY2UiLCJsIiwidG9VcHBlckNhc2UiLCJ1bml0TWFwcGluZyIsInRocmVzaG9sZHMiLCJ3YXJuaW5nIiwiY3JpdGljYWwiLCJ0aHJlc2hvbGQiLCJyZWFsRGF0YVNlcnZpY2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./src/lib/data/real-data-service.ts\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/metrics/historical.ts":
/*!*********************************************!*\
  !*** ./src/pages/api/metrics/historical.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_data_real_data_service__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/data/real-data-service */ \"(api-node)/./src/lib/data/real-data-service.ts\");\n\nasync function handler(req, res) {\n    if (req.method !== 'GET') {\n        return res.status(405).json({\n            message: 'Method not allowed'\n        });\n    }\n    const days = parseInt(req.query.days) || 30;\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - days);\n    try {\n        // Get real historical data\n        const realHistoricalData = await getRealHistoricalData(days);\n        res.status(200).json({\n            success: true,\n            data: realHistoricalData,\n            period: `${days} days`,\n            timestamp: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error('Error fetching historical data:', error);\n        res.status(500).json({\n            success: false,\n            error: 'Failed to fetch historical data',\n            period: `${days} days`,\n            timestamp: new Date().toISOString()\n        });\n    }\n}\nasync function getRealHistoricalData(days) {\n    try {\n        const metricKeys = [\n            'bond_issuance',\n            'bdc_discount',\n            'credit_fund',\n            'bank_provision'\n        ];\n        const historicalData = {};\n        for (const metricKey of metricKeys){\n            const data = await _lib_data_real_data_service__WEBPACK_IMPORTED_MODULE_0__.realDataService.getHistoricalData(metricKey, days);\n            if (data.length > 0) {\n                historicalData[metricKey] = data;\n            }\n        }\n        return historicalData;\n    } catch (error) {\n        console.error('Error getting real historical data:', error);\n        return {};\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvbWV0cmljcy9oaXN0b3JpY2FsLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQytEO0FBRWhELGVBQWVDLFFBQVFDLEdBQW1CLEVBQUVDLEdBQW9CO0lBQzdFLElBQUlELElBQUlFLE1BQU0sS0FBSyxPQUFPO1FBQ3hCLE9BQU9ELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtJQUM5RDtJQUVBLE1BQU1DLE9BQU9DLFNBQVNQLElBQUlRLEtBQUssQ0FBQ0YsSUFBSSxLQUFlO0lBQ25ELE1BQU1HLGFBQWEsSUFBSUM7SUFDdkJELFdBQVdFLE9BQU8sQ0FBQ0YsV0FBV0csT0FBTyxLQUFLTjtJQUUxQyxJQUFJO1FBQ0YsMkJBQTJCO1FBQzNCLE1BQU1PLHFCQUFxQixNQUFNQyxzQkFBc0JSO1FBRXZETCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25CVyxTQUFTO1lBQ1RDLE1BQU1IO1lBQ05JLFFBQVEsR0FBR1gsS0FBSyxLQUFLLENBQUM7WUFDdEJZLFdBQVcsSUFBSVIsT0FBT1MsV0FBVztRQUNuQztJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsbUNBQW1DQTtRQUVqRG5CLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJXLFNBQVM7WUFDVEssT0FBTztZQUNQSCxRQUFRLEdBQUdYLEtBQUssS0FBSyxDQUFDO1lBQ3RCWSxXQUFXLElBQUlSLE9BQU9TLFdBQVc7UUFDbkM7SUFDRjtBQUNGO0FBRUEsZUFBZUwsc0JBQXNCUixJQUFZO0lBQy9DLElBQUk7UUFDRixNQUFNZ0IsYUFBYTtZQUFDO1lBQWlCO1lBQWdCO1lBQWU7U0FBaUI7UUFDckYsTUFBTUMsaUJBQXdDLENBQUM7UUFFL0MsS0FBSyxNQUFNQyxhQUFhRixXQUFZO1lBQ2xDLE1BQU1OLE9BQU8sTUFBTWxCLHdFQUFlQSxDQUFDMkIsaUJBQWlCLENBQUNELFdBQVdsQjtZQUNoRSxJQUFJVSxLQUFLVSxNQUFNLEdBQUcsR0FBRztnQkFDbkJILGNBQWMsQ0FBQ0MsVUFBVSxHQUFHUjtZQUM5QjtRQUNGO1FBRUEsT0FBT087SUFDVCxFQUFFLE9BQU9ILE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHVDQUF1Q0E7UUFDckQsT0FBTyxDQUFDO0lBQ1Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3R1cnBoYWkvUHJvamVjdHMva2lyb19haUNyYXNoL3NyYy9wYWdlcy9hcGkvbWV0cmljcy9oaXN0b3JpY2FsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IHJlYWxEYXRhU2VydmljZSB9IGZyb20gJ0AvbGliL2RhdGEvcmVhbC1kYXRhLXNlcnZpY2UnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnR0VUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IG1lc3NhZ2U6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pO1xuICB9XG5cbiAgY29uc3QgZGF5cyA9IHBhcnNlSW50KHJlcS5xdWVyeS5kYXlzIGFzIHN0cmluZykgfHwgMzA7XG4gIGNvbnN0IGN1dG9mZkRhdGUgPSBuZXcgRGF0ZSgpO1xuICBjdXRvZmZEYXRlLnNldERhdGUoY3V0b2ZmRGF0ZS5nZXREYXRlKCkgLSBkYXlzKTtcblxuICB0cnkge1xuICAgIC8vIEdldCByZWFsIGhpc3RvcmljYWwgZGF0YVxuICAgIGNvbnN0IHJlYWxIaXN0b3JpY2FsRGF0YSA9IGF3YWl0IGdldFJlYWxIaXN0b3JpY2FsRGF0YShkYXlzKTtcbiAgICBcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcmVhbEhpc3RvcmljYWxEYXRhLFxuICAgICAgcGVyaW9kOiBgJHtkYXlzfSBkYXlzYCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgaGlzdG9yaWNhbCBkYXRhOicsIGVycm9yKTtcbiAgICBcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGhpc3RvcmljYWwgZGF0YScsXG4gICAgICBwZXJpb2Q6IGAke2RheXN9IGRheXNgLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRSZWFsSGlzdG9yaWNhbERhdGEoZGF5czogbnVtYmVyKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWV0cmljS2V5cyA9IFsnYm9uZF9pc3N1YW5jZScsICdiZGNfZGlzY291bnQnLCAnY3JlZGl0X2Z1bmQnLCAnYmFua19wcm92aXNpb24nXTtcbiAgICBjb25zdCBoaXN0b3JpY2FsRGF0YTogUmVjb3JkPHN0cmluZywgYW55W10+ID0ge307XG5cbiAgICBmb3IgKGNvbnN0IG1ldHJpY0tleSBvZiBtZXRyaWNLZXlzKSB7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVhbERhdGFTZXJ2aWNlLmdldEhpc3RvcmljYWxEYXRhKG1ldHJpY0tleSwgZGF5cyk7XG4gICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGhpc3RvcmljYWxEYXRhW21ldHJpY0tleV0gPSBkYXRhO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBoaXN0b3JpY2FsRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHJlYWwgaGlzdG9yaWNhbCBkYXRhOicsIGVycm9yKTtcbiAgICByZXR1cm4ge307XG4gIH1cbn0iXSwibmFtZXMiOlsicmVhbERhdGFTZXJ2aWNlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZGF5cyIsInBhcnNlSW50IiwicXVlcnkiLCJjdXRvZmZEYXRlIiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwicmVhbEhpc3RvcmljYWxEYXRhIiwiZ2V0UmVhbEhpc3RvcmljYWxEYXRhIiwic3VjY2VzcyIsImRhdGEiLCJwZXJpb2QiLCJ0aW1lc3RhbXAiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwiY29uc29sZSIsIm1ldHJpY0tleXMiLCJoaXN0b3JpY2FsRGF0YSIsIm1ldHJpY0tleSIsImdldEhpc3RvcmljYWxEYXRhIiwibGVuZ3RoIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/metrics/historical.ts\n");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fmetrics%2Fhistorical&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fmetrics%2Fhistorical.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();