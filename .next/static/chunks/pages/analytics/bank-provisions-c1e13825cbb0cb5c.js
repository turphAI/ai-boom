(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[200],{8475:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/analytics/bank-provisions",function(){return a(7699)}])},7699:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var s=a(5893),n=a(7294),i=a(8223),r=a(4942),l=a(4055),c=a(6485),o=a(9858),d=a(4672),h=a(9062),x=a(3219),m=a(116),g=a(7727),u=a(1222),j=a(1664),p=a.n(j),v=a(5492),y=a(8522),f=a(8400);function b(){let[e,t]=(0,n.useState)(null),[a,j]=(0,n.useState)([]),[b,N]=(0,n.useState)(!0),[w,k]=(0,n.useState)(null),[B,D]=(0,n.useState)({isOpen:!1,title:"",data:[],dataKey:"value",color:"#ef4444",unit:"%",type:"line"}),[T,F]=(0,n.useState)(!1),[P,_]=(0,n.useState)({start:new Date(Date.now()-7776e6),end:new Date}),[C,Z]=(0,n.useState)([]),[M,O]=(0,n.useState)([]);(0,n.useEffect)(()=>{R()},[]);let R=async()=>{try{N(!0),k(null);let e=await fetch("/api/metrics/current"),a=await e.json();if(!a.success)throw Error("Failed to fetch current metrics");let s=a.metrics.find(e=>"bank_provision"===e.key);if(!s)throw Error("Bank provision metric not found");let n=await fetch("/api/metrics/historical?days=365"),i=await n.json();if(!i.success)throw Error("Failed to fetch historical data");let r=i.data.bank_provision||[],l={currentValue:s.value,changePercent:s.changePercent,trend:s.changePercent>2?"up":s.changePercent<-2?"down":"stable",status:s.status,historicalData:r.map(e=>({timestamp:e.timestamp,value:e.value,date:e.date||e.timestamp.split("T")[0]})),breakdown:{byBank:[{name:"JPMorgan Chase",value:.25*s.value,percentage:25},{name:"Bank of America",value:.2*s.value,percentage:20},{name:"Wells Fargo",value:.15*s.value,percentage:15},{name:"Citigroup",value:.15*s.value,percentage:15},{name:"Other Banks",value:.25*s.value,percentage:25}],byRegion:[{region:"North America",value:.6*s.value,percentage:60},{region:"Europe",value:.25*s.value,percentage:25},{region:"Asia Pacific",value:.15*s.value,percentage:15}],bySize:[{size:"Large Banks (>$100B)",value:.7*s.value,percentage:70},{size:"Mid Banks ($10B-$100B)",value:.2*s.value,percentage:20},{size:"Small Banks (<$10B)",value:.1*s.value,percentage:10}]},insights:{keyTrends:["Bank provisions are ".concat(s.changePercent>0?"increasing":"decreasing"," by ").concat(Math.abs(s.changePercent).toFixed(1),"%"),"Current provision rate: ".concat(s.value.toFixed(1),"%"),"Trend suggests ".concat(s.changePercent>0?"increasing":"decreasing"," risk assessment")],riskFactors:s.value>12?["High bank provisions may indicate deteriorating credit quality","Increasing provisions suggest banks are preparing for potential defaults"]:[],recommendations:["Monitor loan loss reserves and credit quality metrics","Track non-performing loan ratios","Watch for signs of credit deterioration in key sectors"]}};t(l),j(l.historicalData),O(l.historicalData)}catch(e){console.error("Error fetching analytics:",e),k(e instanceof Error?e.message:"Failed to fetch analytics")}finally{N(!1)}},E=(e,t,a,s,n)=>{D({isOpen:!0,title:t,data:e,dataKey:"value",color:a,unit:s,type:n})},S=(e,t,s)=>{let n=a.filter(a=>{let s=new Date(a.timestamp);return s>=e&&s<=t});s.length,O(n)},Y=e=>{switch(e){case"increasing":return(0,s.jsx)(o.Z,{className:"h-4 w-4 text-red-600"});case"decreasing":return(0,s.jsx)(d.Z,{className:"h-4 w-4 text-green-600"});default:return(0,s.jsx)(h.Z,{className:"h-4 w-4 text-gray-600"})}},z=e=>{let t=Math.abs(e);return t>.7?"bg-green-100 text-green-600":t>.4?"bg-yellow-100 text-yellow-600":t>.2?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"};return b?(0,s.jsx)(i.c,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"text-lg",children:"Loading analytics..."})})}):w?(0,s.jsx)(i.c,{children:(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-red-600",children:w})})}):e?(0,s.jsx)(i.c,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center space-x-2 mb-2",children:(0,s.jsx)(p(),{href:"/analytics",children:(0,s.jsxs)(c.z,{variant:"ghost",size:"sm",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Back to Analytics"]})})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Bank Provisions Analytics"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Analyze banking sector risk assessment and provision trends"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)(r.Zb,{children:(0,s.jsxs)(r.aY,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Total Provisions"}),Y(e.trend)]}),(0,s.jsxs)("div",{className:"text-3xl font-bold text-gray-900",children:["$",e.currentValue.toFixed(1),"%"]}),(0,s.jsxs)("div",{className:"text-sm mt-2 ".concat(e.changePercent>0?"text-red-600":"text-green-600"),children:[e.changePercent>0?"+":"",e.changePercent.toFixed(1),"% from previous period"]})]})}),(0,s.jsx)(r.Zb,{children:(0,s.jsxs)(r.aY,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Trend"}),(0,s.jsx)(l.C,{variant:"up"===e.trend?"destructive":"down"===e.trend?"default":"secondary",children:e.trend})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-gray-900 capitalize",children:e.trend}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-2",children:"Risk assessment pattern"})]})}),(0,s.jsx)(r.Zb,{children:(0,s.jsxs)(r.aY,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Red Flags"}),"critical"===e.status&&(0,s.jsx)(m.Z,{className:"h-5 w-5 text-red-500"})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:e.status}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-2",children:"Current status"})]})})]}),(0,s.jsxs)(r.Zb,{children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,s.jsx)(g.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Category Breakdown"})]})}),(0,s.jsx)(r.aY,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Object.entries(e.breakdown).map(t=>{let[a,n]=t;return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 capitalize",children:a.replace(/([A-Z])/g," $1")}),Y(e.trend)]}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"byBank"===a?"".concat(n.length," Banks"):"".concat(n.length," Regions")}),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-2",children:"byBank"===a?"Top Banks by Provision Value":"Top Regions by Provision Value"})]},a)})})})]}),(0,s.jsxs)(r.Zb,{children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,s.jsx)(u.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Cross-Metric Correlations"})]})}),(0,s.jsx)(r.aY,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(e.breakdown).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 capitalize",children:t.replace(/([A-Z])/g," $1").replace("By","")}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"byBank"===t?"".concat(a.length," Banks"):"".concat(a.length," Regions")}),(0,s.jsx)(l.C,{className:z(0),children:"byBank"===t?"Top Banks":"Top Regions"}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"byBank"===t?"Top Banks by Provision Value":"Top Regions by Provision Value"})]},t)})})})]}),e.insights.riskFactors.length>0&&(0,s.jsxs)(r.Zb,{children:[(0,s.jsx)(r.Ol,{children:(0,s.jsxs)(r.ll,{className:"flex items-center space-x-2 text-red-700",children:[(0,s.jsx)(m.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Risk Factors & Recommendations"})]})}),(0,s.jsx)(r.aY,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[e.insights.riskFactors.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-red-50 rounded-lg",children:[(0,s.jsx)(m.Z,{className:"h-5 w-5 text-red-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-red-800",children:e}),(0,s.jsx)("div",{className:"text-sm text-red-600 mt-1",children:"This may indicate increased systemic risk in the banking sector."})]})]},t)),(0,s.jsx)("div",{className:"text-sm text-gray-600 mt-2",children:"Recommendations:"}),(0,s.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600",children:e.insights.recommendations.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]})})]}),(0,s.jsx)(v.u,{title:"Bank Provisions Historical Trend",data:a,dataKey:"value",color:"#ef4444",unit:"%",type:"line",showTrend:!0,height:400,dangerThreshold:15,warningThreshold:10,enableZoom:!0,enableDrillDown:!0,onDrillDown:e=>E(e,"Bank Provisions Historical Trend","#ef4444","%","line"),formatValue:e=>"".concat(e.toFixed(1),"%"),formatDate:e=>{let t=new Date(e),a=Math.floor(t.getMonth()/3)+1,s=t.getFullYear();return"Q".concat(a," ").concat(s)},filteredData:M,showFilteredData:M.length!==a.length}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)(v.u,{title:"Commercial Real Estate",data:a.slice(0,8),dataKey:"value",color:"#3b82f6",unit:"%",type:"line",showTrend:!0,height:300,formatValue:e=>"".concat(e.toFixed(1),"%"),formatDate:e=>{let t=new Date(e),a=Math.floor(t.getMonth()/3)+1,s=t.getFullYear();return"Q".concat(a," ").concat(s)}}),(0,s.jsx)(v.u,{title:"Technology Lending",data:a.slice(0,8),dataKey:"value",color:"#10b981",unit:"%",type:"line",showTrend:!0,height:300,formatValue:e=>"".concat(e.toFixed(1),"%"),formatDate:e=>{let t=new Date(e),a=Math.floor(t.getMonth()/3)+1,s=t.getFullYear();return"Q".concat(a," ").concat(s)}}),(0,s.jsx)(v.u,{title:"Consumer Credit",data:a.slice(0,8),dataKey:"value",color:"#f59e0b",unit:"%",type:"line",showTrend:!0,height:300,formatValue:e=>"".concat(e.toFixed(1),"%"),formatDate:e=>{let t=new Date(e),a=Math.floor(t.getMonth()/3)+1,s=t.getFullYear();return"Q".concat(a," ").concat(s)}})]}),(0,s.jsx)(y.Y,{isOpen:B.isOpen,onClose:()=>{D(e=>({...e,isOpen:!1}))},title:B.title,data:B.data,dataKey:B.dataKey,color:B.color,unit:B.unit,type:B.type}),(0,s.jsx)(f.h,{isOpen:T,onToggle:()=>F(!T),onDateRangeChange:(e,t)=>{_({start:e,end:t}),S(e,t,C)},availableMetrics:["bank_provision","commercial_real_estate","technology_lending","consumer_credit"],selectedMetrics:C,onMetricsChange:e=>{Z(e),S(P.start,P.end,e)},onResetFilters:()=>{_({start:new Date(Date.now()-7776e6),end:new Date}),Z([]),O(a)},activeFiltersCount:(M.length!==a.length?1:0)+(C.length>0?1:0)})]})}):(0,s.jsx)(i.c,{children:(0,s.jsx)("div",{className:"text-center py-8",children:(0,s.jsx)("p",{className:"text-gray-600",children:"No analytics data available"})})})}}},function(e){e.O(0,[281,263,976,153,617,589,120,785,774,888,179],function(){return e(e.s=8475)}),_N_E=e.O()}]);